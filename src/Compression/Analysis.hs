{-# LANGUAGE TupleSections #-}

module Compression.Analysis where

import           Data.Char
import qualified Data.Map.Strict               as Map

-- | Constructs a histogram mapping characters to the number of times they occur
-- in some string.
freqList :: String -> [(Char, Int)]
freqList = Map.toList . Map.fromListWith (+) . map (, 1)

-- | Constructs an association list mapping every ASCII character to its number
-- of occurrences in a given string.
--
-- Assumes that `str` is a pure ASCII string.
analyseAsciiFrequency :: String -> [(Char, Int)]
analyseAsciiFrequency str = freqList $ ascii ++ str
  where ascii = chr <$> [0 .. 127]

-- | A character frequency sample from inline (i.e., no '\n') JSON data.
jsonFrequency :: [(Char, Int)]
jsonFrequency =
  [ ('\NUL', 1)
  , ('\SOH', 1)
  , ('\STX', 1)
  , ('\ETX', 1)
  , ('\EOT', 1)
  , ('\ENQ', 1)
  , ('\ACK', 1)
  , ('\a'  , 1)
  , ('\b'  , 1)
  , ('\t'  , 1)
  , ('\n'  , 1)
  , ('\v'  , 1)
  , ('\f'  , 1)
  , ('\r'  , 1)
  , ('\SO' , 1)
  , ('\SI' , 1)
  , ('\DLE', 1)
  , ('\DC1', 1)
  , ('\DC2', 1)
  , ('\DC3', 1)
  , ('\DC4', 1)
  , ('\NAK', 1)
  , ('\SYN', 1)
  , ('\ETB', 1)
  , ('\CAN', 1)
  , ('\EM' , 1)
  , ('\SUB', 1)
  , ('\ESC', 1)
  , ('\FS' , 1)
  , ('\GS' , 1)
  , ('\RS' , 1)
  , ('\US' , 1)
  , (' '   , 14709)
  , ('!'   , 1)
  , ('"'   , 27491)
  , ('#'   , 2)
  , ('$'   , 1)
  , ('%'   , 1)
  , ('&'   , 6)
  , ('\''  , 32)
  , ('('   , 10)
  , (')'   , 10)
  , ('*'   , 1)
  , ('+'   , 3)
  , (','   , 6396)
  , ('-'   , 214)
  , ('.'   , 414)
  , ('/'   , 59)
  , ('0'   , 644)
  , ('1'   , 1386)
  , ('2'   , 882)
  , ('3'   , 691)
  , ('4'   , 488)
  , ('5'   , 395)
  , ('6'   , 416)
  , ('7'   , 425)
  , ('8'   , 419)
  , ('9'   , 952)
  , (':'   , 6674)
  , (';'   , 6)
  , ('<'   , 21)
  , ('='   , 1)
  , ('>'   , 21)
  , ('?'   , 1)
  , ('@'   , 1)
  , ('A'   , 203)
  , ('B'   , 154)
  , ('C'   , 184)
  , ('D'   , 96)
  , ('E'   , 131)
  , ('F'   , 182)
  , ('G'   , 143)
  , ('H'   , 170)
  , ('I'   , 73)
  , ('J'   , 157)
  , ('K'   , 97)
  , ('L'   , 119)
  , ('M'   , 270)
  , ('N'   , 197)
  , ('O'   , 47)
  , ('P'   , 191)
  , ('Q'   , 5)
  , ('R'   , 172)
  , ('S'   , 271)
  , ('T'   , 142)
  , ('U'   , 24)
  , ('V'   , 29)
  , ('W'   , 127)
  , ('X'   , 12)
  , ('Y'   , 22)
  , ('Z'   , 11)
  , ('['   , 599)
  , ('\\'  , 2164)
  , (']'   , 599)
  , ('^'   , 1)
  , ('_'   , 1)
  , ('`'   , 1)
  , ('a'   , 13018)
  , ('b'   , 886)
  , ('c'   , 5414)
  , ('d'   , 4256)
  , ('e'   , 17190)
  , ('f'   , 4097)
  , ('g'   , 2260)
  , ('h'   , 5493)
  , ('i'   , 13152)
  , ('j'   , 53)
  , ('k'   , 380)
  , ('l'   , 4369)
  , ('m'   , 5289)
  , ('n'   , 10363)
  , ('o'   , 11257)
  , ('p'   , 2046)
  , ('q'   , 88)
  , ('r'   , 12510)
  , ('s'   , 9331)
  , ('t'   , 12074)
  , ('u'   , 3938)
  , ('v'   , 2274)
  , ('w'   , 920)
  , ('x'   , 138)
  , ('y'   , 3111)
  , ('z'   , 293)
  , ('{'   , 1598)
  , ('|'   , 1)
  , ('}'   , 1598)
  , ('~'   , 1)
  , ('\DEL', 1)
  ]

-- | A character frequency sample from the complete works of Shakespeare.
asciiFrequency :: [(Char, Int)]
asciiFrequency =
  [ ('\NUL', 1)
  , ('\SOH', 1)
  , ('\STX', 1)
  , ('\ETX', 1)
  , ('\EOT', 1)
  , ('\ENQ', 1)
  , ('\ACK', 1)
  , ('\a'  , 1)
  , ('\b'  , 1)
  , ('\t'  , 1)
  , ('\n'  , 124457)
  , ('\v'  , 1)
  , ('\f'  , 1)
  , ('\r'  , 1)
  , ('\SO' , 1)
  , ('\SI' , 1)
  , ('\DLE', 1)
  , ('\DC1', 1)
  , ('\DC2', 1)
  , ('\DC3', 1)
  , ('\DC4', 1)
  , ('\NAK', 1)
  , ('\SYN', 1)
  , ('\ETB', 1)
  , ('\CAN', 1)
  , ('\EM' , 1)
  , ('\SUB', 1)
  , ('\ESC', 1)
  , ('\FS' , 1)
  , ('\GS' , 1)
  , ('\RS' , 1)
  , ('\US' , 1)
  , (' '   , 1293935)
  , ('!'   , 8845)
  , ('"'   , 471)
  , ('#'   , 2)
  , ('$'   , 1)
  , ('%'   , 2)
  , ('&'   , 22)
  , ('\''  , 31070)
  , ('('   , 629)
  , (')'   , 630)
  , ('*'   , 64)
  , ('+'   , 1)
  , (','   , 83175)
  , ('-'   , 8075)
  , ('.'   , 78026)
  , ('/'   , 6)
  , ('0'   , 300)
  , ('1'   , 929)
  , ('2'   , 367)
  , ('3'   , 331)
  , ('4'   , 94)
  , ('5'   , 83)
  , ('6'   , 64)
  , ('7'   , 42)
  , ('8'   , 41)
  , ('9'   , 949)
  , (':'   , 1828)
  , (';'   , 17200)
  , ('<'   , 469)
  , ('='   , 2)
  , ('>'   , 442)
  , ('?'   , 10477)
  , ('@'   , 9)
  , ('A'   , 44487)
  , ('B'   , 15414)
  , ('C'   , 21498)
  , ('D'   , 15684)
  , ('E'   , 42584)
  , ('F'   , 11714)
  , ('G'   , 11165)
  , ('H'   , 18463)
  , ('I'   , 55807)
  , ('J'   , 2068)
  , ('K'   , 6197)
  , ('L'   , 23859)
  , ('M'   , 15873)
  , ('N'   , 27339)
  , ('O'   , 33210)
  , ('P'   , 11940)
  , ('Q'   , 1179)
  , ('R'   , 28971)
  , ('S'   , 34012)
  , ('T'   , 39801)
  , ('U'   , 14130)
  , ('V'   , 3581)
  , ('W'   , 16497)
  , ('X'   , 607)
  , ('Y'   , 9100)
  , ('Z'   , 533)
  , ('['   , 2086)
  , ('\\'  , 1)
  , (']'   , 2078)
  , ('^'   , 1)
  , ('_'   , 72)
  , ('`'   , 2)
  , ('a'   , 244665)
  , ('b'   , 46544)
  , ('c'   , 66689)
  , ('d'   , 133780)
  , ('e'   , 404622)
  , ('f'   , 68804)
  , ('g'   , 57036)
  , ('h'   , 218407)
  , ('i'   , 198185)
  , ('j'   , 2713)
  , ('k'   , 29213)
  , ('l'   , 146162)
  , ('m'   , 95581)
  , ('n'   , 215925)
  , ('o'   , 281392)
  , ('p'   , 46526)
  , ('q'   , 2405)
  , ('r'   , 208895)
  , ('s'   , 214979)
  , ('t'   , 289976)
  , ('u'   , 114819)
  , ('v'   , 33990)
  , ('w'   , 72895)
  , ('x'   , 4689)
  , ('y'   , 85272)
  , ('z'   , 1100)
  , ('{'   , 1)
  , ('|'   , 34)
  , ('}'   , 3)
  , ('~'   , 2)
  , ('\DEL', 1)
  ]
